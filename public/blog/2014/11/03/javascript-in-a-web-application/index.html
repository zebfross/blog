
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>JavaScript in Web Applications - Musings of a Software Enthusiast</title>
	<meta name="author" content="Zeb Fross">

	
	<meta name="description" content="JavaScript in Web Applications Harnessing the power of JavaScript in a web application can improve speed, flexibility, and overall user experience. &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Musings of a Software Enthusiast" type="application/atom+xml">
	
	<link rel="canonical" href="http://blog.zebfross.com/blog/2014/11/03/javascript-in-a-web-application/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	
	
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	<img src="/images/profile.jpeg" alt="Profile Picture" style="width: 160px;" />
	
</div>
<section>
  <h2>About Me</h2>
  <p>A software enthusiast with a passion for writing beautiful code.  Love contributing when I can.</p>
</section>

<nav id="main-nav"><ul class="main">
    <li><a href="/" target="_top">Blog</a></li>
    <li><a href="/blog/archives" target="_top">Archives</a></li>
    <li><a href="http://zebfross.com" target="_top">Zebfross.com</a></li>
</ul>

</nav>
<nav id="sub-nav">
	<div class="social">
		
			<a class="email" href="mailto:zebfross@hotmail.com" title="Email">Email</a>
		
		
		
		
		
			<a class="github" href="https://github.com/zebfross" title="GitHub" target="_blank">GitHub</a>
		
		
		
		
		
		
		
		
		
		
    	
    	
			<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">JavaScript in Web Applications</h1>
	<div class="entry-content" itemprop="articleBody"><p>Harnessing the power of JavaScript in a web application can improve speed, flexibility, and overall user experience.  Here are some basics regarding the use of JavaScript.</p>

<p>When retrieving server data, there are a few choices of format.  Most commonly, the server will return data formatted as JSON or data formatted as HTML.  If JSON is returned, the client will parse the response and decide for itself what to do with the information.  If HTML is returned, the client will most likely place the html somewhere on the page.  Both options have advantages and disadvantages.</p>

<p>As a common theme that will be seen in many of my future articles, jQuery isn&rsquo;t the only library for doing ajax requests.  Any of the following are perfectly good (and lighter-weight) alternatives.</p>

<p style="text-align:center;"><a href="https://github.com/ForbesLindesay/ajax" target="_blank">ajax</a> | <a href="https://github.com/then/request" target="_blank">request</a> | <a href="https://github.com/ded/Reqwest" target="_blank">reqwest</a></p>

<h2>Retrieving HTML Data</h2>

<figure class='code'><figcaption><span>scripts.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>reqwest({
</span><span class='line'>  url: '/Client/Index',
</span><span class='line'>  method: 'GET',
</span><span class='line'>  type: 'html',
</span><span class='line'>  success: function (html) {
</span><span class='line'>      console.log(html);
</span><span class='line'>  },
</span><span class='line'>  error: function (err) {
</span><span class='line'>      console.log(err);
</span><span class='line'>  }
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>/*
</span><span class='line'>prints:
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>    &lt;li&gt;Bob Johnson&lt;/li&gt;
</span><span class='line'>    &lt;li&gt;Sally Sue&lt;/li&gt;
</span><span class='line'>    &lt;li&gt;Chris Howard&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>*/</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>ClientController.cs</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public partial class ClientController : Controller
</span><span class='line'>{
</span><span class='line'>  private BlogContext db = new BlogContext();
</span><span class='line'>
</span><span class='line'>  public ActionResult Index()
</span><span class='line'>  {
</span><span class='line'>      return PartialView("List", db.Clients());
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>List.cshtml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>@model IEnumerable&lt;Blog.Client&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>@foreach(Blog.Client c in Model)
</span><span class='line'>{
</span><span class='line'>    &lt;li&gt;@c.FullName&lt;/li&gt;
</span><span class='line'>}
</span><span class='line'>&lt;/ul&gt;</span></code></pre></td></tr></table></div></figure>


<h2>Retrieving JSON Data</h2>

<figure class='code'><figcaption><span>scripts.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>reqwest({ // reqwest library
</span><span class='line'>  url: '/Client/Index',
</span><span class='line'>  method: 'GET',
</span><span class='line'>  type: 'json', // means we will get a json object passed to our success function
</span><span class='line'>  success: function (json) {
</span><span class='line'>      console.log(json);
</span><span class='line'>  },
</span><span class='line'>  error: function (err) {
</span><span class='line'>      console.log(err);
</span><span class='line'>  }
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>/*
</span><span class='line'>prints:
</span><span class='line'>[
</span><span class='line'>  {
</span><span class='line'>      "FirstName" : "Bob",
</span><span class='line'>      "LastName" : "Johnson",
</span><span class='line'>      "Location" : null,
</span><span class='line'>      "BirthDate" : "\/Date(344502000000)\/"
</span><span class='line'>  },
</span><span class='line'>  ...
</span><span class='line'>]
</span><span class='line'>*/</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>ClientController.cs</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public class ClientController : Controller
</span><span class='line'>{
</span><span class='line'>  private BlogContext db = new BlogContext();
</span><span class='line'>
</span><span class='line'>  public JsonResult Index()
</span><span class='line'>  {
</span><span class='line'>      return Json(db.Clients(), JsonRequestBehavior.AllowGet);
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h2>Gotchas</h2>

<ol>
<li><strong>&ldquo;Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource&hellip;&rdquo;</strong><br/>
Browsers prevent javascript from making requests to other domains.  Fortunately, modern browsers &ndash; clear back to IE8 &ndash; support CORS.  Refer to <a href="#cors">the CORS section below</a> for how to implement it.</li>
</ol>


<h2>Sending Data to the Server</h2>

<figure class='code'><figcaption><span>scripts.js </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var data = "FirstName={{FirstName}}&LastName={{LastName}}&Location={{Location}}&BirthDate={{BirthDate}}";
</span><span class='line'>data = data.replace(/{{FirstName}}/g, document.getElementById("FirstName").value);
</span><span class='line'>data = data.replace(/{{LastName}}/g, document.getElementById("LastName").value);
</span><span class='line'>data = data.replace(/{{Location}}/g, document.getElementById("Location").value);
</span><span class='line'>data = data.replace(/{{BirthDate}}/g, document.getElementById("BirthDate").value);
</span><span class='line'>// note that jQuery makes this more succinct: 'data = $("#client-form").serialize();'
</span><span class='line'>
</span><span class='line'>reqwest({
</span><span class='line'>  url: document.forms["client-form"].action,
</span><span class='line'>  method: document.forms["client-form"].method,
</span><span class='line'>  type: 'html',
</span><span class='line'>  data: data,
</span><span class='line'>  success: function () {
</span><span class='line'>      console.log("success");
</span><span class='line'>  },
</span><span class='line'>  error: function () {
</span><span class='line'>      console.log("error");
</span><span class='line'>  }
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p></p>

<figure class='code'><figcaption><span>ClientController.cs</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>public partial class ClientController : Controller
</span><span class='line'>{
</span><span class='line'>  private BlogContext db = new BlogContext();
</span><span class='line'>
</span><span class='line'>  public ActionResult Create()
</span><span class='line'>  {
</span><span class='line'>      return View();
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  [HttpPost()]
</span><span class='line'>  public ActionResult Create(Client model)
</span><span class='line'>  {
</span><span class='line'>      db.AddClient(model);
</span><span class='line'>      return RedirectToAction("Index");
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Please note that the above action method accepts a complex object as a parameter.  This works because of the .NET framework, but there is a gotcha that is explained below.</p>

<figure class='code'><figcaption><span>Create.cshtml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;form id="client-form" action="@Url.Action("Create")" method="post"&gt;
</span><span class='line'>    &lt;label for="FirstName"&gt;First Name:&lt;/label&gt; &lt;input type="text" name="FirstName" id="FirstName" /&gt;
</span><span class='line'>    &lt;label for="LastName"&gt;Last Name:&lt;/label&gt; &lt;input type="text" name="LastName" id="LastName" /&gt;
</span><span class='line'>    &lt;label for="Location"&gt;Location:&lt;/label&gt; &lt;input type="text" name="Location" id="Location" /&gt;
</span><span class='line'>    &lt;label for="BirthDate"&gt;Date of Birth:&lt;/label&gt; &lt;input type="datetime" name="BirthDate" id="BirthDate" /&gt;
</span><span class='line'>&lt;/form&gt;</span></code></pre></td></tr></table></div></figure>


<h2>Submitting json data:</h2>

<figure class='code'><figcaption><span>scripts.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var data = {"FirstName": ..., "LastName": ...};
</span><span class='line'>
</span><span class='line'>reqwest({
</span><span class='line'>  url: document.forms["client-form"].action,
</span><span class='line'>  method: document.forms["client-form"].method,
</span><span class='line'>  type: 'json',
</span><span class='line'>  data: data,
</span><span class='line'>  success: function () {
</span><span class='line'>      console.log("success");
</span><span class='line'>  },
</span><span class='line'>  error: function () {
</span><span class='line'>      console.log("error");
</span><span class='line'>  }
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>The server does not need to change to accept json data.</p>

<h2>Gotchas</h2>

<ol>
<li><p><strong>The action method parameter isn&rsquo;t being populated even though the data is being sent.</strong><br/>
By far the sneakiest cause of this issue is that the .NET framework only populates <em>properties</em> of an object.  Thus, even if the object type has the correct members, the members have to be declared as properties, not just public fields.</p></li>
<li><p><strong>The action method parameter isn&rsquo;t being populated, but I&rsquo;m not sure if the data is being sent correctly or not.</strong><br/>
Use the browser&rsquo;s developer tools to inspect the request being sent.  It should show exactly what data was sent to the server.  Make sure the data was actually sent and that the variables are named correctly.</p></li>
</ol>


<h2><a id="cors"></a>Cross-Origin Resource Sharing (CORS)</h2>

<p>It is common to see the &ldquo;cross-origin request blocked&hellip;&rdquo; error when playing with JavaScript.  Unfortunately, the solution is less common; most resort to server proxies or JSONP.  There is, however, another option that is both elegant and unobtrusive, and the best part is that it works in most browsers clear back to IE8!  Here is how it works:</p>

<ol>
<li>A request is made with JavaScript.</li>
<li>Seeing that it is a cross-origin request, the browser first sends an HTTP OPTIONS request (no different than POST, PUT, etc.) to the exact same url.</li>
<li>If the server responds to the OPTIONS request with the <em>correct headers</em>, the browser allows the request to continue.</li>
</ol>


<p>Nifty, right?  In order to implement it, the server must respond with the &ldquo;Access-Control-Allow-Origin&rdquo; header set to the origin of the requester.  In .NET, this can be done with the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>String origin = HttpContext.Request.UrlReferrer.Scheme + "://" + HttpContext.Request.UrlReferrer.Authority;
</span><span class='line'>HttpContext.Response.Headers.Add("Access-Control-Allow-Origin", origin);</span></code></pre></td></tr></table></div></figure>


<p>Note that some say to add &ldquo;Access-Control-Allow-Origin: *&rdquo;, but that doesn&rsquo;t work it all situations.  Lists also do not work, as in &ldquo;Access-Control-Allow-Origin: domain.com, another.com.&rdquo;  The safest path is the one described above.  In the case of cross-origin file uploads, the following header may also be required:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Access-Control-Allow-Headers: Content-Type, Content-Range, Content-Disposition, Content-Description</span></code></pre></td></tr></table></div></figure>


<p>If cookies are being sent along in the request, set the <em>Access Control Allow Credentials</em> to <em>true</em>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Access-Control-Allow-Credentials: true</span></code></pre></td></tr></table></div></figure>


<h2>Gotchas</h2>

<ol>
<li><p><strong>It still says &ldquo;cross-origin request blocked&hellip;&rdquo;, and the headers are <em>not</em> being set correctly.</strong><br/>
Make sure the server isn&rsquo;t throwing an exception.  The headers may not be set correctly in that case, causing the request to fail.  Also, make sure the server responds correctly to HTTP OPTIONS requests.  Try making a request with <a href="https://addons.mozilla.org/en-US/firefox/addon/httprequester/" target="_blank">HTTPRequester</a> or other tool.</p></li>
<li><p><strong>It still says &ldquo;cross-origin request blocked&hellip;&rdquo;, and the headers <em>are</em> being set correctly.</strong><br/>
Make sure the access-control-allow-origin header is <em>exactly</em> the same as the origin header property in the request, e.g. no trailing slashes.  Also keep in mind that the browser gives this &ldquo;cross-origin request blocked&hellip;&rdquo; error very liberally even in situations where the request wasn&rsquo;t blocked, the server just returned an error code.</p></li>
</ol>

</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2014

    Zeb Fross


<link href="/javascripts/google-code-prettify/prettify.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="/javascripts/google-code-prettify/prettify.js"></script>
<script type="text/javascript">
    document.body.onload = function() {
        var preTags = document.querySelectorAll("pre");
        for (var i = 0; i < preTags.length; i++) {
            var tag = preTags[i];
            tag.className = tag.className + " prettyprint";
        }
        prettyPrint();
    };
</script>
Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html" target="_blank">Shashank Mehta</a>
Powered by: <a href="http://octopress.org" target="_blank">Octopress</a></footer>
		</div>
	</div>
	

<script type="text/javascript">
      var disqus_shortname = 'zebfross';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.zebfross.com/blog/2014/11/03/javascript-in-a-web-application/';
        var disqus_url = 'http://blog.zebfross.com/blog/2014/11/03/javascript-in-a-web-application/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
